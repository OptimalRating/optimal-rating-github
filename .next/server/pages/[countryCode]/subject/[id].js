"use strict";(()=>{var e={};e.id=305,e.ids=[305,888],e.modules={6611:(e,t,r)=>{r.r(t),r.d(t,{config:()=>j,default:()=>b,getServerSideProps:()=>U,getStaticPaths:()=>E,getStaticProps:()=>C,reportWebVitals:()=>x,routeModule:()=>L,unstable_getServerProps:()=>y,unstable_getServerSideProps:()=>P,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>w,unstable_getStaticProps:()=>M});var n={};r.r(n),r.d(n,{default:()=>N,getServerSideProps:()=>D});var o=r(6505),a=r(9143),i=r(7517),d=r(2968),l=r(7228),s=r(997),c=r(6689),u=r(1259),_=r(491),m=r.n(_),p=r(6210),h=r(3592),O=r(2703),f=r(505),v=r(3985),g=r(3108);(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module '__barrel_optimize__?names=SortAscendingOutlined!=!@ant-design/icons'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'lodash/orderBy'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'react-i18next'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module '__barrel_optimize__?names=Cell,Pie,PieChart!=!recharts'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'pica'");throw e.code="MODULE_NOT_FOUND",e}();let D=async()=>({props:{res:await (0,f.oM)()}}),N=({match:e,res:t})=>{let r=(0,h.useRouter)(),{t:n}=Object(function(){var e=Error("Cannot find module 'react-i18next'");throw e.code="MODULE_NOT_FOUND",e}())(),{id:o}=r.query,[a,i]=(0,c.useState)("vote"),[d,l]=(0,c.useState)(!0),[_,D]=(0,c.useState)({take:5,page:0,offset:0}),[N,b]=(0,c.useState)(null),[C,E]=(0,c.useState)(null),[U,j]=(0,c.useState)(!1),[x,M]=(0,c.useState)(""),w=(0,c.useCallback)(async()=>{try{let e=await Object(function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}())(`${O.lp}subjectHasSurvey/${o}?orderBy=${a}&take=${_.take}&page=${_.page}&offset=${_.offset}`,{headers:{country:"null"===(0,u.NI)()?"world":(0,u.NI)()}});console.log("Survey Data:",e.data),b(e.data),l(!1)}catch(e){console.error("Error fetching survey data:",e.response?.data)}},[o,a,_]);(0,c.useEffect)(()=>{(0,f.mh)(t),o&&w()},[t,o,w,a,_]);let S=(0,u.oU)((0,u.U2)(N,"result.set.surveys",[]),!0);(0,c.useEffect)(()=>{let e=async(e,t)=>{let r=new Image;r.src=`${O.cO}survey/${e}`,r.crossOrigin="Anonymous",r.onload=async()=>{let e=document.createElement("canvas"),n=document.createElement("canvas");e.width=r.width,e.height=r.height,n.width=200,n.height=200,e.getContext("2d").drawImage(r,0,0);try{let r=Object(function(){var e=Error("Cannot find module 'pica'");throw e.code="MODULE_NOT_FOUND",e}())();await r.resize(e,n),n.toBlob(e=>{let r=URL.createObjectURL(e);M(e=>({...e,[t]:r}))},"image/jpeg")}catch(e){console.error("Image resizing error:",e)}}};S.forEach(t=>{let r=`${(0,u.NI)()}-${t.id}.png`;x[t.id]||e(r,t.id)})},[N,x,S]);let y=(0,c.createRef)(),P=e=>{E(e)},L=e=>{(0,f.qC)({url:`${O.lp}submitVote/${e}`,data:{choice_id:C&&C.id}}).then(e=>{notification.success({message:n("msg.success_mark")}),j(!1),E(!1),refresh()}).catch(e=>{"msg.info.not_approved"===e.message?Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()).confirm({title:n("lbl.cancel_vote"),content:n("msg.must_approved"),onOk:()=>r.push(`/${(0,u.NI)()}/profile`)}):"msg.info.country_vote_notallowed"===e.message?notification.error({message:n("msg.error_country_vote_notallowed")}):notification.error({message:n("msg.error_mark")}),j(!1)})},T=(e,t)=>{j(!0),Promise.all(t.map(t=>(0,f.Yu)({url:`${O.lp}cancelVote/${e}/${t}`}))).then(()=>{L(e)}).catch(()=>{j(!1)})},$=e=>{j(!0);let t=e?.id;Promise.all(e?.choices.map(r=>f.Yu({url:`${O.lp}checkVote/${t}/${r.id}`}).then(t=>({surveyId:e?.id,response:t})).catch(()=>({surveyId:e?.id,response:null})))).then(e=>{let r=e.filter(e=>e.response);if(r.length>0){j(!1);let e=r[0].surveyId;Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()).confirm({title:n("lbl.cancel_vote"),content:n("lbl.survey_already_voted"),onOk:()=>T(e,r.map(e=>e.response.result.set.choice_id))})}else L(t)})},F=[{name:"A",value:400},{name:"B",value:300},{name:"C",value:300},{name:"D",value:200}],[z,B]=(0,c.useState)(null),I=e=>{B(e)},k=()=>{B(null)},q=()=>{B(null)};return s.jsx(p.Z,{children:s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{spinning:d,children:s.jsx(v.HY,{isEmpty:0===S.length,children:(0,s.jsxs)(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{className:"SurveyDetail",title:s.jsx("h1",{style:{fontSize:"20px",fontWeight:"600"},children:(0,u.U2)(N,"result.set.title")}),extra:s.jsx(()=>s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{overlay:(0,s.jsxs)(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{onClick:({key:e})=>i(e),style:{pointerEvents:"all"},children:[s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()).Item,{children:"Latest"},"date"),s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()).Item,{children:"Highest Vote"},"vote")]}),children:s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{type:"link",icon:s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=SortAscendingOutlined!=!@ant-design/icons'");throw e.code="MODULE_NOT_FOUND",e}()),{})})}),{}),bordered:!1,children:[s.jsx("div",{className:"SurveyItems",children:Object(function(){var e=Error("Cannot find module 'lodash/orderBy'");throw e.code="MODULE_NOT_FOUND",e}())(S,"vote"===a?"vote":e=>e.created_at,"vote"===a?"desc":"asc").map((e,t)=>s.jsx("div",{className:"SurveyItem",children:(0,s.jsxs)("div",{className:"SurveyContent",children:[s.jsx("div",{className:"Label",style:{cursor:"pointer",fontSize:"16px",marginBottom:"15px"},children:s.jsx(m(),{href:`/${(0,u.NI)()}/survey/special/${e.id}/details`,children:s.jsx("a",{children:e.title})})}),s.jsx(v.wW,{data:(0,u.oU)(e&&e.choices,!0),selected:C,onClick:P,isSpecial:!0,chartImageName:`${(0,u.NI)()}-${e&&e.id}.png`,url:`/${(0,u.NI)()}/special/${e&&e.slug}`}),(0,s.jsxs)("div",{className:"mt-20 pl-10",children:[(0,s.jsxs)("div",{className:"d-flex",children:[s.jsx(v.y3,{showChild:!0,children:s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{type:"primary",disabled:!C,onClick:()=>$(e),loading:U,children:n("lbl.vote")})}),s.jsx("p",{className:"ml-auto",style:{color:"#3a99ab",marginRight:"5px",marginTop:"4px"},children:n("msg.display")}),s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Cell,Pie,PieChart!=!recharts'");throw e.code="MODULE_NOT_FOUND",e}()),{style:{cursor:"pointer",marginRight:"2px"},width:35,height:35,children:s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Cell,Pie,PieChart!=!recharts'");throw e.code="MODULE_NOT_FOUND",e}()),{data:F,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:15,fill:"#8884d8",label:!0,onClick:()=>I(t),children:F.map((e,t)=>s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Cell,Pie,PieChart!=!recharts'");throw e.code="MODULE_NOT_FOUND",e}()),{fill:["#ff7300","#ffbf00","#0088fe","#00c49f"][t]},`cell-${t}`))})}),z===t&&s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{title:n("msg.modal_title"),open:z===t,onOk:k,onCancel:q,width:700,children:s.jsx(g.Z,{data:(0,u.oU)(e&&e.choices,!0),ref:y,chartImageName:`${(0,u.NI)()||"default"}-${e&&e.id}.png`})}),s.jsx(v.mB,{title:e&&e.title||"",url:x,pageUrl:`null/${(0,u.NI)()}/special/${e&&e.slug}`,chartRef:""})]}),s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{})]})]})},e.id))}),s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{}),s.jsx(Object(function(){var e=Error("Cannot find module '__barrel_optimize__?names=Button,Card,Divider,Dropdown,Menu,Modal,Pagination,Spin!=!antd'");throw e.code="MODULE_NOT_FOUND",e}()),{style:{margin:"28px auto",textAlign:"center"},pageSize:_.take,current:_.page+1,total:(0,u.U2)(N,"result.pagination.recordCount"),onChange:(e,t)=>{D({..._,page:e-1,offset:(e-1)*t,take:t})}})]})})})})},b=(0,i.l)(n,"default"),C=(0,i.l)(n,"getStaticProps"),E=(0,i.l)(n,"getStaticPaths"),U=(0,i.l)(n,"getServerSideProps"),j=(0,i.l)(n,"config"),x=(0,i.l)(n,"reportWebVitals"),M=(0,i.l)(n,"unstable_getStaticProps"),w=(0,i.l)(n,"unstable_getStaticPaths"),S=(0,i.l)(n,"unstable_getStaticParams"),y=(0,i.l)(n,"unstable_getServerProps"),P=(0,i.l)(n,"unstable_getServerSideProps"),L=new o.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/[countryCode]/subject/[id]",pathname:"/[countryCode]/subject/[id]",bundlePath:"",filename:""},components:{App:l.default,Document:d.default},userland:n})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[620,785,769,228,221],()=>r(6611));module.exports=n})();